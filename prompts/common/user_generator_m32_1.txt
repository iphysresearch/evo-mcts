## Algorithm Optimization Task
Develop an enhanced gravitational signal processing algorithm for interferometer data analysis by implementing concrete improvements from multi-level code analysis.

## Technical Context
1. Optimization Depth Specifications:
- Current Focus Level: {depth} (max_depth={max_depth})
  (1-2: Control flow restructuring, 3-4: Numerical computation optimizations, 5+: Advanced linear algebra methods)
- Code Analysis Insights from Prior Level:
```text
{reflection}
```

2. Base Implementation Details:
[Functional Purpose] {algorithm_description}
[Core Implementation] 
```python
{algorithm_code}
```

## Implementation Directives (Depth {depth}):
- Shallow (1-2): Restructure control flow using reflection suggestion (e.g., split data conditioning/analysis phases)
- Medium (3-4): Apply numerical optimizations from reflection (e.g., FFT window size optimization)
- Deep (5+): Implement matrix computation improvements from reflection (e.g., regularized inverse covariance)

{external_knowledge}

## Output Format
- Place the core design idea in a sentence within a brace BEFORE the function definition
- For the core design idea format: \\{{A hybrid gravitational wave detection pipeline...}}
- Implement as Python function: {func_name}
- Inputs: {input_count} parameter(s) ({joined_inputs})
- Outputs: {output_count} return value(s) ({joined_outputs})
- Follow: {inout_inf}
- Constraints: {other_inf}
- IMPORTANT: All output code MUST be valid Python syntax. Do not place description text inside curly braces within the function body.
- Example of correct format:
  \\{{Core design description here}}
  ```python
  def pipeline_v2(strain_h1: np.ndarray, strain_l1: np.ndarray, times: np.ndarray) -> tuple[np.ndarray, np.ndarray, np.ndarray]:
      """Core design description can alternatively be placed here as a docstring"""
      # Function implementation...
  ```

## Important Notes
- Focus on algorithmic improvements rather than code style changes
- Ensure the new implementation directly addresses the reflection insights
